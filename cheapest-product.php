<!DOCTYPE html>
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<head>
    <meta charset="utf-8">
    <title>北京智通智慧科技有限公司 | 特价产品</title>
    <meta name="description" content="北京智通智慧科技有限公司">
    <meta name="author" content="杭城小刘">

    <!-- Mobile Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Favicon -->
    <link rel="shortcut icon" href="style/images/img/favicon.ico">

    <!-- Web Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700,300&amp;subset=latin,latin-ext' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=PT+Serif' rel='stylesheet' type='text/css'>

    <!-- Bootstrap core CSS -->
    <link href="style/css/bootstrap.css" rel="stylesheet">

    <!-- Font Awesome CSS -->
    <link href="style/css/font-awesome.css" rel="stylesheet">

    <!-- Fontello CSS -->
    <link href="style/css/fontello.css" rel="stylesheet">

    <!-- Plugins -->
    <link href="style/css/settings.css" media="screen" rel="stylesheet">
    <link href="style/css/extralayers.css" media="screen" rel="stylesheet">
    <link href="style/css/magnific-popup.css" rel="stylesheet">
    <link href="style/css/animations.css" rel="stylesheet">
    <link href="style/css/owl.carousel.css" rel="stylesheet">

    <!-- iDea core CSS file -->
    <link href="style/css/style.css" rel="stylesheet">

    <!-- Style Switcher Styles (Remove these two lines) -->
    <link href="#" data-style="styles" rel="stylesheet">
    <link href="style/css/style-switcher.css" rel="stylesheet">
    <script src="http://cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script>
    <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
    <!-- Custom css -->
    <link href="style/css/custom.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="style/js/html5shiv.min.js"></script>
    <script src="style/js/respond.min.js"></script>
    <![endif]-->
</head>

<!-- body classes:
        "boxed": boxed layout mode e.g. <body class="boxed">
        "pattern-1 ... pattern-9": background patterns for boxed layout mode e.g. <body class="boxed pattern-1">
-->
<body class="front no-trans">
<!-- scrollToTop -->
<!-- ================ -->
<div class="scrollToTop"><i class="icon-up-open-big"></i></div>

<!-- page wrapper start -->
<!-- ================ -->
<div class="page-wrapper">

    <!-- header-top start (Add "dark" class to .header-top in order to enable dark header-top e.g <div class="header-top dark">) -->
    <!-- ================ -->

    <!-- header-top end -->

    <!-- header start classes:
        fixed: fixed navigation mode (sticky menu) e.g. <header class="header fixed clearfix">
         dark: dark header version e.g. <header class="header dark clearfix">
    ================ -->
    <?php
    require_once "controller/Header.php";
    $header = Header::getInstance();
    $header->headerGenerate(3,3);
    ?>
    <!-- header end -->

    <!-- banner start -->
    <!-- ================ -->
    <div class="banner shop-banner">

        <!-- slideshow start -->
        <!-- ================ -->
        <div class="slideshow white-bg">

            <!-- slider revolution start -->
            <!-- ================ -->
            <!-- ================ -->
            <div class="slider-banner-container">
                <div class="slider-banner">
                    <ul>
                        <!-- slide 1 start -->
                        <li data-transition="fade" data-slotamount="7" data-masterspeed="1000" data-saveperformance="on" data-title="Slide 1">

                            <!-- main image -->
                            <img src="style/images/slider-shop-slide-1.jpg"  alt="slidebg1" data-bgposition="center top" data-bgfit="cover" data-bgrepeat="no-repeat">

                            <!-- Translucent background -->
                            <div class="tp-caption light-translucent-bg"
                                 data-x="center"
                                 data-y="bottom"
                                 data-speed="800"
                                 data-start="0"
                                 style="background-color:rgba(255,255,255,0.4);">
                            </div>

                            <!-- LAYER NR. 1 -->
                            <div class="tp-caption very_large_text hidden-sm black sfl tp-resizeme"
                                 data-x="center"
                                 data-y="150"
                                 data-speed="200"
                                 data-start="0"
                                 data-end="10000"
                                 data-endspeed="200"
                                 data-splitin="chars"
                                 data-elementdelay="0.07"
                                 data-endelementdelay="0.1"
                                 data-splitout="chars">特价商品
                            </div>

                            <!-- LAYER NR. 2 -->
                            <div class="tp-caption tp-resizeme hidden-sm sfb"
                                 data-x="center"
                                 data-y="230"
                                 data-speed="700"
                                 data-start="600"
                                 data-end="10000"
                                 data-endspeed="600"><a href="page-services.php" class="btn btn-dark">立即查看 <i class="fa fa-angle-right pl-10"></i></a>
                            </div>

                        </li>
                        <!-- slide 1 end -->

                        <!-- slide 2 start -->
                        <li data-transition="fade" data-slotamount="7" data-masterspeed="1000" data-saveperformance="on" data-title="Slide 2">

                            <!-- main image -->
                            <img src="style/images/slider-shop-slide-2.jpg"  alt="slidebg1" data-bgposition="center top" data-bgfit="cover" data-bgrepeat="no-repeat">

                            <!-- Translucent background -->
                            <div class="tp-caption light-translucent-bg"
                                 data-x="center"
                                 data-y="bottom"
                                 data-speed="800"
                                 data-start="0"
                                 style="background-color:rgba(255,255,255,0.4);">
                            </div>

                            <!-- LAYER NR. 1 -->
                            <div class="tp-caption very_large_text hidden-sm sft black tp-resizeme"
                                 data-x="center"
                                 data-y="150"
                                 data-speed="700"
                                 data-start="200"
                                 data-end="10000"
                                 data-endspeed="600">甄品选购
                            </div>

                            <!-- LAYER NR. 2 -->
                            <div class="tp-caption tp-resizeme hidden-sm sfb"
                                 data-x="center"
                                 data-y="230"
                                 data-speed="700"
                                 data-start="600"
                                 data-end="10000"
                                 data-endspeed="600"><a href="page-services.php" class="btn btn-dark">立即购买 <i class="fa fa-angle-right pl-10"></i></a>
                            </div>

                        </li>
                        <!-- slide 2 end -->

                    </ul>
                </div>
            </div>
            <!-- slider revolution end -->

        </div>
        <!-- slideshow end -->

        <div class="sorting-filters">
            <div class="container">
                <form class="form-inline">
                    <div class="form-group">
                        <label>分类</label>
                        <select class="form-control" id="order">
                            <option value="">--请选择--</option>
                            <option value="sales">销量</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>排序</label>
                        <select class="form-control" id="direction">
                            <option value="">--请选择--</option>
                            <option value="ASC">升序</option>
                            <option value="DESC">降序</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>产品类别</label>
                        <select class="form-control" id="productBigKind">
                            <option value="">--请选择--</option>
                            <option value="药检试剂">药检试剂</option>
                            <option value="生化酶">生化酶</option>
                            <option value="检测试剂">检测试剂</option>
                            <option value="消毒用试剂">消毒用试剂</option>
                            <option value="细胞因子">细胞因子</option>
                            <option value="其它产品">其它产品</option>
                            <option value="检测试纸卡">检测试纸卡</option>
                            <option value="速测盒">速测盒</option>
                            <option value="检测仪器">检测仪器</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <a id="search" class="btn btn-default">查询</a>
                    </div>
                </form>
            </div>
        </div>

    </div>
    <!-- banner end -->

    <!-- main-container start -->
    <!-- ================ -->
    <section class="main-container">

        <div class="container">
            <div class="row">

                <!-- main start -->
                <!-- ================ -->
                <div class="main col-md-12">

                    <!-- page-title start -->
                    <!-- ================ -->
                    <h1 class="page-title">特价产品</h1>
                    <div class="separator-2"></div>
                    <!-- page-title end -->

                    <!-- shop items start -->
                    <div class="masonry-grid-fitrows row grid-space-10" id="shopZone">

                    </div>
                    <!-- shop items end -->

                    <div class="clearfix"></div>

                    <!-- pagination start -->
                    <ul class="pagination">
                        <li><a href="#">«</a></li>
                        <li class="active"><a href="#">1 <span class="sr-only">(current)</span></a></li>
                        <li><a href="#">2</a></li>
                        <li><a href="#">3</a></li>
                        <li><a href="#">4</a></li>
                        <li><a href="#">5</a></li>
                        <li><a href="#">»</a></li>
                    </ul>
                    <!-- pagination end -->

                </div>
                <!-- main end -->

            </div>
        </div>
    </section>
    <!-- main-container end -->

    <!-- section start -->
    <!-- ================ -->

    <!-- section end -->

    <!-- section start -->
    <!-- ================ -->

    <!-- section end -->

    <!-- section start -->
    <!-- ================ -->

    <!-- section end -->

    <!-- footer start (Add "light" class to #footer in order to enable light footer) -->
    <!-- ================ -->
    <?php
    require_once "controller/Footer.php";
    ?>
    <!-- footer end -->

</div>
<!-- page-wrapper end -->

<!-- JavaScript files placed at the end of the document so the pages load faster
================================================== -->
<!-- Jquery and Bootstap core js files -->
<script type="text/javascript" src="style/js/jquery.min.js"></script>
<script type="text/javascript" src="style/js/bootstrap.min.js"></script>

<!-- Modernizr javascript -->
<script type="text/javascript" src="style/js/modernizr.js"></script>

<!-- jQuery REVOLUTION Slider  -->
<script type="text/javascript" src="style/js/jquery.themepunch.tools.min.js"></script>
<script type="text/javascript" src="style/js/jquery.themepunch.revolution.min.js"></script>

<!-- Isotope javascript -->
<script type="text/javascript" src="style/js/isotope.pkgd.min.js"></script>

<!-- Owl carousel javascript -->
<script type="text/javascript" src="style/js/owl.carousel.js"></script>

<!-- Magnific Popup javascript -->
<script type="text/javascript" src="style/js/jquery.magnific-popup.min.js"></script>

<!-- Appear javascript -->
<script type="text/javascript" src="style/js/jquery.appear.js"></script>

<!-- Count To javascript -->
<script type="text/javascript" src="style/js/jquery.countTo.js"></script>

<!-- Parallax javascript -->
<script src="style/js/jquery.parallax-1.1.3.js"></script>

<!-- Contact form -->
<script src="style/js/jquery.validate.js"></script>

<!-- SmoothScroll javascript -->
<script type="text/javascript" src="style/js/jquery.browser.js"></script>
<script type="text/javascript" src="style/js/SmoothScroll.js"></script>

<!-- Initialization of Plugins -->
<script type="text/javascript" src="style/js/template.js"></script>

<!-- Custom Scripts -->
<script type="text/javascript" src="style/js/custom.js"></script>
<!-- Color Switcher (Remove these lines) -->
<script type="text/javascript" src="style/js/style-switcher.js"></script>

<!-- Color Switcher End -->
<script>
    var $page = 1;
    function updateUI($this,page) {
        $(".pagination li").each(function () {
            $(this).removeClass("active");
        });
        $($this).parent().addClass("active");
        $page = page;
        refreshView(page);
    }

    function refreshView(page) {
        var $node = $("#shopZone");
        $node.empty();
        //加载产品列表
        $.ajax({
            dataType: "json",
            type: "get",
            url: "controller/productlist.php?type=特价商品&page="+$page,
            success: function (data) {
                if (data.code == 200) {
                    var datas = data.data.datas;
                    if(datas.length <= 0){
                        $('<div class="row center-block" style="margin: 10px;" >喵~没找到相关的商品哦。</div>').appendTo($node);
                        return ;
                    }
                    for (var i = 0; i < datas.length; i++) {
                        $('<div class="col-lg-3 col-md-4 col-sm-6 masonry-grid-item">' +
                            '<div class="listing-item">' +
                            '<div class="overlay-container">' +
                            '<img src="'+ datas[i].image1 + '" alt="">' +
                            '<a href="productDetail.php?id='+datas[i].id+'&type=特价商品" class="overlay small">' +
                            '<i class="fa fa-plus"></i>' +
                            '<span>查看详情</span>' +
                            '</a>' +
                            '</div>' +
                            '<div class="listing-item-body clearfix">' +
                            '<h3 class="title"><a href="productDetail.php?id='+datas[i].id+'&type=特价商品">' + datas[i].productName + '</a></h3>' +
                            '<p>' + datas[i].unit + '</p>' +
                            '</div>' +
                            '</div>' +
                            '</div>').appendTo($node);
                    }
                    $node.css("height","auto");
                    if(page != "" && page != 0){
                        return ;
                    }
                    var $pagetarget = $(".pagination");
                    $pagetarget.empty();
                    var pages = Math.ceil(data.data.totals/28);
                    for(var $i=0;$i<pages+2;$i++){
                        if($i == 0){
                            $('<li><a>«</a></li>').appendTo($pagetarget);
                        }else if($i == 1){
                            $('<li class="active"><a onclick="updateUI(this,1);">1 <span class="sr-only">(current)</span></a></li>').appendTo($pagetarget);
                        }else if($i == pages+1){
                            $('<li><a>»</a></li>').appendTo($pagetarget);
                        }else{
                            $('<li><a onclick="updateUI(this,'+$i+');">'+$i+'</a></li>').appendTo($pagetarget);
                        }
                    }
                }
            },
            error: function (code, message, data) {
                alert("发生错误：" + message);
            }
        });
    }

    refreshView(0);

    $("#search").click(function(){

        var order = $("#order").val();
        var direction = $("#direction").val();
        var productBigKind = $("#productBigKind").val();
        var page = 1;

        var $node = $("#shopZone");
        $node.empty();
        $.ajax({
            dataType: "json",
            type: "get",
            url: "controller/productlist.php?type=特价商品&order="+order+"&direction="+direction+"&productBigKind="+productBigKind+"&page="+page,
            success: function (data) {
                if (data.code == 200) {
                    var $pagetarget = $(".pagination");
                    var datas = data.data.datas;
                    if(datas.length <= 0){
                        $pagetarget.empty();
                        $('<div class="row center-block" style="margin: 10px;" >喵~没找到相关的商品哦。</div>').appendTo($node);
                        $node.css("height","auto");
                        return ;
                    }
                    for (var i = 0; i < datas.length; i++) {
                        $('<div class="col-md-3 col-sm-6 masonry-grid-item">' +
                            '<div class="listing-item">' +
                            '<div class="overlay-container">' +
                            '<img src="'+ datas[i].image1 + '" alt="">' +
                            '<a href="productDetail.php?id='+datas[i].id+'&type=特价商品" class="overlay small">' +
                            '<i class="fa fa-plus"></i>' +
                            '<span>查看详情</span>' +
                            '</a>' +
                            '</div>' +
                            '<div class="listing-item-body clearfix">' +
                            '<h3 class="title"><a href="productDetail.php?id='+datas[i].id+'&type=特价商品">' + datas[i].productName + '</a></h3>' +
                            '<p>' + datas[i].unit + '</p>' +
                            '</div>' +
                            '</div>' +
                            '</div>').appendTo($node);
                    }
                    $node.css("height","auto");
                    $pagetarget.empty();
                    var pages = Math.ceil(data.data.totals/28);
                    for(var $i=0;$i<pages+2;$i++){
                        if($i == 0){
                            $('<li><a>«</a></li>').appendTo($pagetarget);
                        }else if($i == 1){
                            $('<li class="active"><a onclick="updateUI(this,1);">1 <span class="sr-only">(current)</span></a></li>').appendTo($pagetarget);
                        }else if($i == pages+1){
                            $('<li><a>»</a></li>').appendTo($pagetarget);
                        }else{
                            $('<li><a onclick="updateUI(this,'+$i+');">'+$i+'</a></li>').appendTo($pagetarget);
                        }
                    }
                }
            },
            error: function (code, message, data) {
                alert("发生错误：" + message);
            }
        });
    });
</script>

</body>
</html>
